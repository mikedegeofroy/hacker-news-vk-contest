{"version":3,"sources":["../../../../../src/lib/floating/useFloatingMiddlewaresBootstrap/index.ts"],"sourcesContent":["import * as React from 'react';\nimport {\n  arrowMiddleware,\n  autoPlacementMiddleware,\n  flipMiddleware,\n  hideMiddleware,\n  offsetMiddleware,\n  shiftMiddleware,\n  sizeMiddleware,\n} from '../adapters';\nimport { checkIsNotAutoPlacement, getAutoPlacementAlign } from '../functions';\nimport type { ArrowOptions, PlacementWithAuto, UseFloatingMiddleware } from '../types/common';\n\nexport interface UseFloatingMiddlewaresBootstrapOptions {\n  /**\n   * По умолчанию компонент выберет наилучшее расположение сам. Но его можно задать извне с помощью этого свойства.\n   */\n  placement?: PlacementWithAuto;\n  /**\n   * Отступ по главной оси.\n   */\n  offsetByMainAxis?: number;\n  /**\n   * Отступ по вспомогательной оси.\n   */\n  offsetByCrossAxis?: number;\n  arrowRef?: ArrowOptions['element'];\n  /**\n   * Отображать ли стрелку, указывающую на якорный элемент.\n   */\n  arrow?: boolean;\n  /**\n   * Высота стрелки. Складывается с `mainAxis`, чтобы стрелка не залезала на якорный элемент.\n   */\n  arrowHeight?: number;\n  /**\n   * Безопасная зона вокруг стрелки, чтобы та не выходила за края контента.\n   */\n  arrowPadding?: number;\n  /**\n   * Выставлять ширину равной target элементу.\n   */\n  sameWidth?: boolean;\n  /**\n   * Массив кастомных модификаторов для Popper (необходимо мемоизировать).\n   */\n  customMiddlewares?: UseFloatingMiddleware[];\n  /**\n   * Принудительно скрывает компонент если целевой элемент вышел за область видимости.\n   */\n  hideWhenReferenceHidden?: boolean;\n}\n\nexport const useFloatingMiddlewaresBootstrap = ({\n  placement = 'bottom-start',\n  arrowRef = null,\n  arrow,\n  arrowHeight,\n  arrowPadding,\n  sameWidth,\n  offsetByMainAxis = 0,\n  offsetByCrossAxis = 0,\n  customMiddlewares,\n  hideWhenReferenceHidden,\n}: UseFloatingMiddlewaresBootstrapOptions) => {\n  return React.useMemo(() => {\n    const isNotAutoPlacement = checkIsNotAutoPlacement(placement);\n    const middlewares: UseFloatingMiddleware[] = [\n      offsetMiddleware({\n        crossAxis: offsetByCrossAxis,\n        mainAxis: arrow && arrowHeight ? offsetByMainAxis + arrowHeight : offsetByMainAxis,\n      }),\n    ];\n\n    // см. https://floating-ui.com/docs/flip#conflict-with-autoplacement\n    if (isNotAutoPlacement) {\n      middlewares.push(\n        flipMiddleware({\n          fallbackAxisSideDirection: 'start',\n        }),\n      );\n    } else {\n      middlewares.push(autoPlacementMiddleware({ alignment: getAutoPlacementAlign(placement) }));\n    }\n\n    middlewares.push(shiftMiddleware());\n\n    if (sameWidth) {\n      middlewares.push(\n        sizeMiddleware({\n          apply({ rects, elements }) {\n            Object.assign(elements.floating.style, {\n              width: `${rects.reference.width}px`,\n            });\n          },\n        }),\n      );\n    }\n\n    if (customMiddlewares) {\n      middlewares.push(...customMiddlewares);\n    }\n\n    // см. https://floating-ui.com/docs/arrow#order\n    if (arrow) {\n      middlewares.push(\n        arrowMiddleware({\n          element: arrowRef,\n          padding: arrowPadding,\n        }),\n      );\n    }\n\n    if (hideWhenReferenceHidden) {\n      middlewares.push(hideMiddleware());\n    }\n\n    return { middlewares, strictPlacement: isNotAutoPlacement ? placement : undefined };\n  }, [\n    offsetByCrossAxis,\n    arrowRef,\n    arrow,\n    arrowHeight,\n    arrowPadding,\n    offsetByMainAxis,\n    sameWidth,\n    customMiddlewares,\n    placement,\n    hideWhenReferenceHidden,\n  ]);\n};\n"],"names":["useFloatingMiddlewaresBootstrap","placement","arrowRef","arrow","arrowHeight","arrowPadding","sameWidth","offsetByMainAxis","offsetByCrossAxis","customMiddlewares","hideWhenReferenceHidden","React","useMemo","isNotAutoPlacement","checkIsNotAutoPlacement","middlewares","offsetMiddleware","crossAxis","mainAxis","push","flipMiddleware","fallbackAxisSideDirection","autoPlacementMiddleware","alignment","getAutoPlacementAlign","shiftMiddleware","sizeMiddleware","apply","rects","elements","Object","assign","floating","style","width","reference","arrowMiddleware","element","padding","hideMiddleware","strictPlacement","undefined"],"mappings":";;;;+BAqDaA;;;eAAAA;;;;iEArDU;0BAShB;2BACwD;AA2CxD,MAAMA,kCAAkC,CAAC,EAC9CC,YAAY,cAAc,EAC1BC,WAAW,IAAI,EACfC,KAAK,EACLC,WAAW,EACXC,YAAY,EACZC,SAAS,EACTC,mBAAmB,CAAC,EACpBC,oBAAoB,CAAC,EACrBC,iBAAiB,EACjBC,uBAAuB,EACgB;IACvC,OAAOC,OAAMC,OAAO,CAAC;QACnB,MAAMC,qBAAqBC,IAAAA,kCAAuB,EAACb;QACnD,MAAMc,cAAuC;YAC3CC,IAAAA,0BAAgB,EAAC;gBACfC,WAAWT;gBACXU,UAAUf,SAASC,cAAcG,mBAAmBH,cAAcG;YACpE;SACD;QAED,oEAAoE;QACpE,IAAIM,oBAAoB;YACtBE,YAAYI,IAAI,CACdC,IAAAA,wBAAc,EAAC;gBACbC,2BAA2B;YAC7B;QAEJ,OAAO;YACLN,YAAYI,IAAI,CAACG,IAAAA,iCAAuB,EAAC;gBAAEC,WAAWC,IAAAA,gCAAqB,EAACvB;YAAW;QACzF;QAEAc,YAAYI,IAAI,CAACM,IAAAA,yBAAe;QAEhC,IAAInB,WAAW;YACbS,YAAYI,IAAI,CACdO,IAAAA,wBAAc,EAAC;gBACbC,OAAM,EAAEC,KAAK,EAAEC,QAAQ,EAAE;oBACvBC,OAAOC,MAAM,CAACF,SAASG,QAAQ,CAACC,KAAK,EAAE;wBACrCC,OAAO,CAAC,EAAEN,MAAMO,SAAS,CAACD,KAAK,CAAC,EAAE,CAAC;oBACrC;gBACF;YACF;QAEJ;QAEA,IAAIzB,mBAAmB;YACrBM,YAAYI,IAAI,IAAIV;QACtB;QAEA,+CAA+C;QAC/C,IAAIN,OAAO;YACTY,YAAYI,IAAI,CACdiB,IAAAA,yBAAe,EAAC;gBACdC,SAASnC;gBACToC,SAASjC;YACX;QAEJ;QAEA,IAAIK,yBAAyB;YAC3BK,YAAYI,IAAI,CAACoB,IAAAA,wBAAc;QACjC;QAEA,OAAO;YAAExB;YAAayB,iBAAiB3B,qBAAqBZ,YAAYwC;QAAU;IACpF,GAAG;QACDjC;QACAN;QACAC;QACAC;QACAC;QACAE;QACAD;QACAG;QACAR;QACAS;KACD;AACH"}