{"version":3,"sources":["../../../../src/components/CalendarDays/CalendarDays.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useTodayDate } from '../../hooks/useTodayDate';\nimport { getDaysNames, getWeeks } from '../../lib/calendar';\nimport { isSameDay, isSameMonth } from '../../lib/date';\nimport { HTMLAttributesWithRootRef } from '../../types';\nimport { CalendarDay, CalendarDayElementProps } from '../CalendarDay/CalendarDay';\nimport { useConfigProvider } from '../ConfigProvider/ConfigProviderContext';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { Footnote } from '../Typography/Footnote/Footnote';\nimport styles from './CalendarDays.module.css';\n\nexport interface CalendarDaysProps\n  extends Omit<HTMLAttributesWithRootRef<HTMLDivElement>, 'onChange'> {\n  value?: Date | Array<Date | null>;\n  viewDate: Date;\n  weekStartsOn: 0 | 1 | 2 | 3 | 4 | 5 | 6;\n  showNeighboringMonth?: boolean;\n  size?: 's' | 'm';\n  dayProps?: CalendarDayElementProps;\n  listenDayChangesForUpdate?: boolean;\n  onDayChange(value: Date): void;\n  isDayDisabled(value: Date): boolean;\n  isDaySelectionStart(value: Date, dayOfWeek: number): boolean;\n  isDaySelectionEnd(value: Date, dayOfWeek: number): boolean;\n  isHintedDaySelectionStart?(value: Date, dayOfWeek: number): boolean;\n  isHintedDaySelectionEnd?(value: Date, dayOfWeek: number): boolean;\n  isDayActive(value: Date): boolean;\n  isDayHinted?(value: Date): boolean;\n  isDaySelected?(value: Date): boolean;\n  isDayFocused(value: Date): boolean;\n  onDayEnter?(value: Date): void;\n  onDayLeave?(value: Date): void;\n}\n\nexport const CalendarDays = ({\n  viewDate,\n  value,\n  weekStartsOn,\n  onDayChange,\n  isDaySelected,\n  isDayActive,\n  isDaySelectionEnd,\n  isDaySelectionStart,\n  onDayEnter,\n  onDayLeave,\n  isDayHinted,\n  isHintedDaySelectionStart,\n  isHintedDaySelectionEnd,\n  isDayFocused,\n  isDayDisabled,\n  size,\n  showNeighboringMonth = false,\n  dayProps,\n  listenDayChangesForUpdate = false,\n  getRootRef,\n  ...props\n}: CalendarDaysProps) => {\n  const { locale } = useConfigProvider();\n  const ref = useExternRef(getRootRef);\n  const now = useTodayDate(listenDayChangesForUpdate);\n\n  const weeks = React.useMemo(() => getWeeks(viewDate, weekStartsOn), [weekStartsOn, viewDate]);\n\n  const daysNames = React.useMemo(\n    () => getDaysNames(now, weekStartsOn, locale),\n    [locale, now, weekStartsOn],\n  );\n\n  const handleDayChange = React.useCallback(\n    (date: Date) => {\n      onDayChange(date);\n\n      ref.current?.focus();\n    },\n    [onDayChange, ref],\n  );\n\n  return (\n    <RootComponent {...props} baseClassName={styles['CalendarDays']} getRootRef={ref}>\n      <div\n        className={classNames(\n          styles['CalendarDays__row'],\n          size === 's' && styles['CalendarDays__row--size-s'],\n        )}\n      >\n        {daysNames.map((dayName) => (\n          <Footnote key={dayName} className={styles['CalendarDays__weekday']}>\n            {dayName}\n          </Footnote>\n        ))}\n      </div>\n\n      {weeks.map((week, i) => (\n        <div\n          className={classNames(\n            styles['CalendarDays__row'],\n            size === 's' && styles['CalendarDays__row--size-s'],\n          )}\n          key={i}\n        >\n          {week.map((day, i) => {\n            const sameMonth = isSameMonth(day, viewDate);\n            return (\n              <CalendarDay\n                key={day.toISOString()}\n                day={day}\n                today={isSameDay(day, now)}\n                active={isDayActive(day)}\n                onChange={handleDayChange}\n                hidden={!showNeighboringMonth && !sameMonth}\n                disabled={isDayDisabled(day)}\n                selectionStart={isDaySelectionStart(day, i)}\n                selectionEnd={isDaySelectionEnd(day, i)}\n                hintedSelectionStart={isHintedDaySelectionStart?.(day, i)}\n                hintedSelectionEnd={isHintedDaySelectionEnd?.(day, i)}\n                selected={isDaySelected?.(day)}\n                focused={isDayFocused(day)}\n                onEnter={onDayEnter}\n                onLeave={onDayLeave}\n                hinted={isDayHinted?.(day)}\n                sameMonth={sameMonth}\n                size={size}\n                {...dayProps}\n              />\n            );\n          })}\n        </div>\n      ))}\n    </RootComponent>\n  );\n};\n"],"names":["CalendarDays","viewDate","value","weekStartsOn","onDayChange","isDaySelected","isDayActive","isDaySelectionEnd","isDaySelectionStart","onDayEnter","onDayLeave","isDayHinted","isHintedDaySelectionStart","isHintedDaySelectionEnd","isDayFocused","isDayDisabled","size","showNeighboringMonth","dayProps","listenDayChangesForUpdate","getRootRef","props","locale","useConfigProvider","ref","useExternRef","now","useTodayDate","weeks","React","useMemo","getWeeks","daysNames","getDaysNames","handleDayChange","useCallback","date","current","focus","RootComponent","baseClassName","div","className","classNames","map","dayName","Footnote","key","week","i","day","sameMonth","isSameMonth","CalendarDay","toISOString","today","isSameDay","active","onChange","hidden","disabled","selectionStart","selectionEnd","hintedSelectionStart","hintedSelectionEnd","selected","focused","onEnter","onLeave","hinted"],"mappings":";;;;+BAoCaA;;;eAAAA;;;;;;;iEApCU;sBACI;8BACE;8BACA;0BACU;sBACA;6BAEc;uCACnB;+BACJ;0BACL;AA0BlB,MAAMA,eAAe;QAAC,EAC3BC,QAAQ,EACRC,KAAK,EACLC,YAAY,EACZC,WAAW,EACXC,aAAa,EACbC,WAAW,EACXC,iBAAiB,EACjBC,mBAAmB,EACnBC,UAAU,EACVC,UAAU,EACVC,WAAW,EACXC,yBAAyB,EACzBC,uBAAuB,EACvBC,YAAY,EACZC,aAAa,EACbC,IAAI,EACJC,uBAAuB,KAAK,EAC5BC,QAAQ,EACRC,4BAA4B,KAAK,EACjCC,UAAU,EAEQ,WADfC;QApBHpB;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;;IAGA,MAAM,EAAEE,MAAM,EAAE,GAAGC,IAAAA,wCAAiB;IACpC,MAAMC,MAAMC,IAAAA,0BAAY,EAACL;IACzB,MAAMM,MAAMC,IAAAA,0BAAY,EAACR;IAEzB,MAAMS,QAAQC,OAAMC,OAAO,CAAC,IAAMC,IAAAA,kBAAQ,EAAC9B,UAAUE,eAAe;QAACA;QAAcF;KAAS;IAE5F,MAAM+B,YAAYH,OAAMC,OAAO,CAC7B,IAAMG,IAAAA,sBAAY,EAACP,KAAKvB,cAAcmB,SACtC;QAACA;QAAQI;QAAKvB;KAAa;IAG7B,MAAM+B,kBAAkBL,OAAMM,WAAW,CACvC,CAACC;YAGCZ;QAFApB,YAAYgC;SAEZZ,eAAAA,IAAIa,OAAO,cAAXb,mCAAAA,aAAac,KAAK;IACpB,GACA;QAAClC;QAAaoB;KAAI;IAGpB,qBACE,qBAACe,4BAAa,8CAAKlB;QAAOmB,aAAa;QAA0BpB,YAAYI;sBAC3E,qBAACiB;QACCC,WAAWC,IAAAA,gBAAU,2BAEnB3B,SAAS;OAGVgB,UAAUY,GAAG,CAAC,CAACC,wBACd,qBAACC,kBAAQ;YAACC,KAAKF;YAASH,SAAS;WAC9BG,YAKNjB,MAAMgB,GAAG,CAAC,CAACI,MAAMC,kBAChB,qBAACR;YACCC,WAAWC,IAAAA,gBAAU,2BAEnB3B,SAAS;YAEX+B,KAAKE;WAEJD,KAAKJ,GAAG,CAAC,CAACM,KAAKD;YACd,MAAME,YAAYC,IAAAA,iBAAW,EAACF,KAAKjD;YACnC,qBACE,qBAACoD,wBAAW;gBACVN,KAAKG,IAAII,WAAW;gBACpBJ,KAAKA;gBACLK,OAAOC,IAAAA,eAAS,EAACN,KAAKxB;gBACtB+B,QAAQnD,YAAY4C;gBACpBQ,UAAUxB;gBACVyB,QAAQ,CAAC1C,wBAAwB,CAACkC;gBAClCS,UAAU7C,cAAcmC;gBACxBW,gBAAgBrD,oBAAoB0C,KAAKD;gBACzCa,cAAcvD,kBAAkB2C,KAAKD;gBACrCc,oBAAoB,EAAEnD,sCAAAA,gDAAAA,0BAA4BsC,KAAKD;gBACvDe,kBAAkB,EAAEnD,oCAAAA,8CAAAA,wBAA0BqC,KAAKD;gBACnDgB,QAAQ,EAAE5D,0BAAAA,oCAAAA,cAAgB6C;gBAC1BgB,SAASpD,aAAaoC;gBACtBiB,SAAS1D;gBACT2D,SAAS1D;gBACT2D,MAAM,EAAE1D,wBAAAA,kCAAAA,YAAcuC;gBACtBC,WAAWA;gBACXnC,MAAMA;eACFE;QAGV;AAKV"}