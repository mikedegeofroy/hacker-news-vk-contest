{"version":3,"sources":["../../../src/hooks/useAutoDetectAppearance.ts"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { Appearance, type AppearanceType } from '../lib/appearance';\nimport { useDOM } from '../lib/dom';\nimport { matchMediaListAddListener, matchMediaListRemoveListener } from '../lib/matchMedia';\nimport { useIsomorphicLayoutEffect } from '../lib/useIsomorphicLayoutEffect';\n\n/**\n * @private\n */\nexport const useAutoDetectAppearance = (appearanceProp?: AppearanceType): AppearanceType => {\n  const { window } = useDOM();\n\n  const [appearance, setAppearance] = React.useState<AppearanceType>(\n    appearanceProp || Appearance.LIGHT,\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    if (appearanceProp) {\n      setAppearance(appearanceProp);\n      return noop;\n    }\n\n    const mediaQuery = window ? window.matchMedia('(prefers-color-scheme: dark)') : undefined;\n\n    if (!mediaQuery) {\n      return noop;\n    }\n\n    const check = (event: MediaQueryList | MediaQueryListEvent) => {\n      // eslint-disable-next-line no-restricted-properties\n      setAppearance(event.matches ? Appearance.DARK : Appearance.LIGHT);\n    };\n    check(mediaQuery);\n    matchMediaListAddListener(mediaQuery, check);\n    return () => matchMediaListRemoveListener(mediaQuery, check);\n  }, [window, appearanceProp]);\n\n  return appearance;\n};\n"],"names":["useAutoDetectAppearance","appearanceProp","window","useDOM","appearance","setAppearance","React","useState","Appearance","LIGHT","useIsomorphicLayoutEffect","noop","mediaQuery","matchMedia","undefined","check","event","matches","DARK","matchMediaListAddListener","matchMediaListRemoveListener"],"mappings":";;;;+BAUaA;;;eAAAA;;;;iEAVU;sBACF;4BAC2B;qBACzB;4BACiD;2CAC9B;AAKnC,MAAMA,0BAA0B,CAACC;IACtC,MAAM,EAAEC,MAAM,EAAE,GAAGC,IAAAA,WAAM;IAEzB,MAAM,CAACC,YAAYC,cAAc,GAAGC,OAAMC,QAAQ,CAChDN,kBAAkBO,sBAAU,CAACC,KAAK;IAGpCC,IAAAA,oDAAyB,EAAC;QACxB,IAAIT,gBAAgB;YAClBI,cAAcJ;YACd,OAAOU,UAAI;QACb;QAEA,MAAMC,aAAaV,SAASA,OAAOW,UAAU,CAAC,kCAAkCC;QAEhF,IAAI,CAACF,YAAY;YACf,OAAOD,UAAI;QACb;QAEA,MAAMI,QAAQ,CAACC;YACb,oDAAoD;YACpDX,cAAcW,MAAMC,OAAO,GAAGT,sBAAU,CAACU,IAAI,GAAGV,sBAAU,CAACC,KAAK;QAClE;QACAM,MAAMH;QACNO,IAAAA,qCAAyB,EAACP,YAAYG;QACtC,OAAO,IAAMK,IAAAA,wCAA4B,EAACR,YAAYG;IACxD,GAAG;QAACb;QAAQD;KAAe;IAE3B,OAAOG;AACT"}