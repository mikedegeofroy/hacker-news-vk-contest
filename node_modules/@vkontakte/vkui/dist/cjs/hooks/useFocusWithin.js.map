{"version":3,"sources":["../../../src/hooks/useFocusWithin.ts"],"sourcesContent":["import * as React from 'react';\nimport { useDOM } from '../lib/dom';\nimport { useIsomorphicLayoutEffect } from '../lib/useIsomorphicLayoutEffect';\n\nconst isFocusWithin = <T extends Element>(ref: T, document: Document) =>\n  ref.contains(document.activeElement);\n\nexport function useFocusWithin(ref: React.RefObject<HTMLElement | null>): boolean {\n  const { document } = useDOM();\n  const [focusWithin, setFocusWithin] = React.useState<boolean>(() =>\n    ref.current && document ? isFocusWithin(ref.current, document) : false,\n  );\n\n  useIsomorphicLayoutEffect(function handleAutoFocus() {\n    /* istanbul ignore if: невозможный кейс, т.к. в SSR эффекты не вызываются. Проверка на будущее, если вдруг эффект будет вызываться. */\n    if (!document) {\n      return;\n    }\n\n    const handleFocusOrBlurEvents = () => {\n      if (ref.current) {\n        setFocusWithin(isFocusWithin(ref.current, document));\n      }\n    };\n\n    // Вызываем в начале, чтобы проверить autoFocus\n    void handleFocusOrBlurEvents();\n\n    document.addEventListener('focus', handleFocusOrBlurEvents, { capture: true });\n    document.addEventListener('blur', handleFocusOrBlurEvents, { capture: true });\n    return () => {\n      document.removeEventListener('focus', handleFocusOrBlurEvents, { capture: true });\n      document.removeEventListener('blur', handleFocusOrBlurEvents, { capture: true });\n    };\n  }, []);\n\n  return focusWithin;\n}\n"],"names":["useFocusWithin","isFocusWithin","ref","document","contains","activeElement","useDOM","focusWithin","setFocusWithin","React","useState","current","useIsomorphicLayoutEffect","handleAutoFocus","handleFocusOrBlurEvents","addEventListener","capture","removeEventListener"],"mappings":";;;;+BAOgBA;;;eAAAA;;;;iEAPO;qBACA;2CACmB;AAE1C,MAAMC,gBAAgB,CAAoBC,KAAQC,WAChDD,IAAIE,QAAQ,CAACD,SAASE,aAAa;AAE9B,SAASL,eAAeE,GAAwC;IACrE,MAAM,EAAEC,QAAQ,EAAE,GAAGG,IAAAA,WAAM;IAC3B,MAAM,CAACC,aAAaC,eAAe,GAAGC,OAAMC,QAAQ,CAAU,IAC5DR,IAAIS,OAAO,IAAIR,WAAWF,cAAcC,IAAIS,OAAO,EAAER,YAAY;IAGnES,IAAAA,oDAAyB,EAAC,SAASC;QACjC,oIAAoI,GACpI,IAAI,CAACV,UAAU;YACb;QACF;QAEA,MAAMW,0BAA0B;YAC9B,IAAIZ,IAAIS,OAAO,EAAE;gBACfH,eAAeP,cAAcC,IAAIS,OAAO,EAAER;YAC5C;QACF;QAEA,+CAA+C;QAC/C,KAAKW;QAELX,SAASY,gBAAgB,CAAC,SAASD,yBAAyB;YAAEE,SAAS;QAAK;QAC5Eb,SAASY,gBAAgB,CAAC,QAAQD,yBAAyB;YAAEE,SAAS;QAAK;QAC3E,OAAO;YACLb,SAASc,mBAAmB,CAAC,SAASH,yBAAyB;gBAAEE,SAAS;YAAK;YAC/Eb,SAASc,mBAAmB,CAAC,QAAQH,yBAAyB;gBAAEE,SAAS;YAAK;QAChF;IACF,GAAG,EAAE;IAEL,OAAOT;AACT"}