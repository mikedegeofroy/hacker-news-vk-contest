{"version":3,"sources":["../../../src/hooks/useFocusWithin.ts"],"sourcesContent":["import * as React from 'react';\nimport { useDOM } from '../lib/dom';\nimport { useIsomorphicLayoutEffect } from '../lib/useIsomorphicLayoutEffect';\n\nconst isFocusWithin = <T extends Element>(ref: T, document: Document) =>\n  ref.contains(document.activeElement);\n\nexport function useFocusWithin(ref: React.RefObject<HTMLElement | null>): boolean {\n  const { document } = useDOM();\n  const [focusWithin, setFocusWithin] = React.useState<boolean>(() =>\n    ref.current && document ? isFocusWithin(ref.current, document) : false,\n  );\n\n  useIsomorphicLayoutEffect(function handleAutoFocus() {\n    /* istanbul ignore if: невозможный кейс, т.к. в SSR эффекты не вызываются. Проверка на будущее, если вдруг эффект будет вызываться. */\n    if (!document) {\n      return;\n    }\n\n    const handleFocusOrBlurEvents = () => {\n      if (ref.current) {\n        setFocusWithin(isFocusWithin(ref.current, document));\n      }\n    };\n\n    // Вызываем в начале, чтобы проверить autoFocus\n    void handleFocusOrBlurEvents();\n\n    document.addEventListener('focus', handleFocusOrBlurEvents, { capture: true });\n    document.addEventListener('blur', handleFocusOrBlurEvents, { capture: true });\n    return () => {\n      document.removeEventListener('focus', handleFocusOrBlurEvents, { capture: true });\n      document.removeEventListener('blur', handleFocusOrBlurEvents, { capture: true });\n    };\n  }, []);\n\n  return focusWithin;\n}\n"],"names":["React","useDOM","useIsomorphicLayoutEffect","isFocusWithin","ref","document","contains","activeElement","useFocusWithin","focusWithin","setFocusWithin","useState","current","handleAutoFocus","handleFocusOrBlurEvents","addEventListener","capture","removeEventListener"],"mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,MAAM,QAAQ,aAAa;AACpC,SAASC,yBAAyB,QAAQ,mCAAmC;AAE7E,MAAMC,gBAAgB,CAAoBC,KAAQC,WAChDD,IAAIE,QAAQ,CAACD,SAASE,aAAa;AAErC,OAAO,SAASC,eAAeJ,GAAwC;IACrE,MAAM,EAAEC,QAAQ,EAAE,GAAGJ;IACrB,MAAM,CAACQ,aAAaC,eAAe,GAAGV,MAAMW,QAAQ,CAAU,IAC5DP,IAAIQ,OAAO,IAAIP,WAAWF,cAAcC,IAAIQ,OAAO,EAAEP,YAAY;IAGnEH,0BAA0B,SAASW;QACjC,oIAAoI,GACpI,IAAI,CAACR,UAAU;YACb;QACF;QAEA,MAAMS,0BAA0B;YAC9B,IAAIV,IAAIQ,OAAO,EAAE;gBACfF,eAAeP,cAAcC,IAAIQ,OAAO,EAAEP;YAC5C;QACF;QAEA,+CAA+C;QAC/C,KAAKS;QAELT,SAASU,gBAAgB,CAAC,SAASD,yBAAyB;YAAEE,SAAS;QAAK;QAC5EX,SAASU,gBAAgB,CAAC,QAAQD,yBAAyB;YAAEE,SAAS;QAAK;QAC3E,OAAO;YACLX,SAASY,mBAAmB,CAAC,SAASH,yBAAyB;gBAAEE,SAAS;YAAK;YAC/EX,SAASY,mBAAmB,CAAC,QAAQH,yBAAyB;gBAAEE,SAAS;YAAK;QAChF;IACF,GAAG,EAAE;IAEL,OAAOP;AACT"}