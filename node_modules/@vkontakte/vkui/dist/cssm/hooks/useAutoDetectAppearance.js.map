{"version":3,"sources":["../../../src/hooks/useAutoDetectAppearance.ts"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { Appearance, type AppearanceType } from '../lib/appearance';\nimport { useDOM } from '../lib/dom';\nimport { matchMediaListAddListener, matchMediaListRemoveListener } from '../lib/matchMedia';\nimport { useIsomorphicLayoutEffect } from '../lib/useIsomorphicLayoutEffect';\n\n/**\n * @private\n */\nexport const useAutoDetectAppearance = (appearanceProp?: AppearanceType): AppearanceType => {\n  const { window } = useDOM();\n\n  const [appearance, setAppearance] = React.useState<AppearanceType>(\n    appearanceProp || Appearance.LIGHT,\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    if (appearanceProp) {\n      setAppearance(appearanceProp);\n      return noop;\n    }\n\n    const mediaQuery = window ? window.matchMedia('(prefers-color-scheme: dark)') : undefined;\n\n    if (!mediaQuery) {\n      return noop;\n    }\n\n    const check = (event: MediaQueryList | MediaQueryListEvent) => {\n      // eslint-disable-next-line no-restricted-properties\n      setAppearance(event.matches ? Appearance.DARK : Appearance.LIGHT);\n    };\n    check(mediaQuery);\n    matchMediaListAddListener(mediaQuery, check);\n    return () => matchMediaListRemoveListener(mediaQuery, check);\n  }, [window, appearanceProp]);\n\n  return appearance;\n};\n"],"names":["React","noop","Appearance","useDOM","matchMediaListAddListener","matchMediaListRemoveListener","useIsomorphicLayoutEffect","useAutoDetectAppearance","appearanceProp","window","appearance","setAppearance","useState","LIGHT","mediaQuery","matchMedia","undefined","check","event","matches","DARK"],"mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,UAAU,QAA6B,oBAAoB;AACpE,SAASC,MAAM,QAAQ,aAAa;AACpC,SAASC,yBAAyB,EAAEC,4BAA4B,QAAQ,oBAAoB;AAC5F,SAASC,yBAAyB,QAAQ,mCAAmC;AAE7E;;CAEC,GACD,OAAO,MAAMC,0BAA0B,CAACC;IACtC,MAAM,EAAEC,MAAM,EAAE,GAAGN;IAEnB,MAAM,CAACO,YAAYC,cAAc,GAAGX,MAAMY,QAAQ,CAChDJ,kBAAkBN,WAAWW,KAAK;IAGpCP,0BAA0B;QACxB,IAAIE,gBAAgB;YAClBG,cAAcH;YACd,OAAOP;QACT;QAEA,MAAMa,aAAaL,SAASA,OAAOM,UAAU,CAAC,kCAAkCC;QAEhF,IAAI,CAACF,YAAY;YACf,OAAOb;QACT;QAEA,MAAMgB,QAAQ,CAACC;YACb,oDAAoD;YACpDP,cAAcO,MAAMC,OAAO,GAAGjB,WAAWkB,IAAI,GAAGlB,WAAWW,KAAK;QAClE;QACAI,MAAMH;QACNV,0BAA0BU,YAAYG;QACtC,OAAO,IAAMZ,6BAA6BS,YAAYG;IACxD,GAAG;QAACR;QAAQD;KAAe;IAE3B,OAAOE;AACT,EAAE"}